import requests
import json 
import sys 
import pyfiglet


print(pyfiglet.figlet_format("Pentestblog"))

usage = "Follow this::: python3 exploit.py {Name} {Email} {Password}"

if (len(sys.argv) != 4):
    print((usage))
    sys.exit()

def register():
    print("\n\nTrying to Creating your Account ......")
    data = """
	{
		"name": "%s",
		"email": "%s",
		"password": "%s"
	}
	""" %(sys.argv[1],sys.argv[2],sys.argv[3])
	
    var = json.loads(data)
 
    re = requests.post("http://10.10.11.120:3000/api/user/register", json=var)
    if " " in re.text:
        print("\nUserName & Email Already Exits")
        sys.exit()
    
    print("\n\nTrying to Login with Valid Credential")
	
    if "user" in re.text:
         cred = '{"email": "%s","password": "%s"}'  %(sys.argv[2], sys.argv[3])
         usr_cred = json.loads(cred)
         loginout = requests.post("http://10.10.11.120:3000/api/user/login", json=usr_cred)
         
         print("\n\nChecking your Privileges")
         if "eyJ" in loginout.text:
                    header = {"auth-token": loginout.text}
                    val = requests.get("http://10.10.11.120:3000/api/priv", headers=header)
                    print("\n\n",val.text)
register()

    
    
